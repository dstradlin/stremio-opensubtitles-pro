{"version":3,"file":"index.js","sourceRoot":"","sources":["index.ts"],"names":[],"mappings":"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","sourcesContent":["import iconvLite, { encodingExists, Options as IOptionsIconvLite } from 'iconv-lite';\nimport jschardet from 'jschardet';\nimport console from 'debug-color2/logger';\n\n//import encodingExists = iconvLite.encodingExists;\n\nexport * from './lib/const';\nexport * from './encoding';\n\nimport { codec_data, disableCodecDataWarn } from './encoding';\nimport { IDetectData, vEncoding } from './lib/const';\nimport { codecDataNameToUpperCase, CODEC_DATA_NAME_TO_UPPER_CASE, ENUM_NODE_ENCODING } from './lib/const';\n\nexport {\n\tencodingExists,\n\n\t/*\n\tcodec_data,\n\t_enc,\n\tisNodeEncoding,\n\tNodeEncoding,\n\t*/\n\n\tjschardet,\n\ticonvLite,\n\n\tdisableCodecDataWarn,\n}\n\n/**\n * 停用編碼檢測警告\n */\nexport function skipDecodeWarning(bool: boolean = true): boolean\n{\n\t// @ts-ignore\n\treturn iconvLite.skipDecodeWarning = bool;\n}\n\n/**\n * 將輸入內容轉換為 Buffer\n */\nexport function BufferFrom(str: unknown, encoding: vEncoding = 'utf8', from?: vEncoding, options?: IOptionsIconvLite): Buffer\n{\n\tlet data;\n\n\tif (from)\n\t{\n\t\tdata = Buffer.from(str as any, from as BufferEncoding);\n\t}\n\telse if (ArrayBuffer.isView(str))\n\t{\n\t\tdata = Buffer.from(str.buffer, str.byteOffset, str.byteLength);\n\t}\n\telse if (str instanceof ArrayBuffer)\n\t{\n\t\tdata = Buffer.from(str);\n\t}\n\telse\n\t{\n\t\tdata = str;\n\t}\n\n\tdata = decode(data);\n\tlet buf = iconvLite.encode(data, encoding, options);\n\n\treturn buf;\n}\n\n/**\n * 檢測輸入內容編碼\n */\nexport function detect(str, plus?: boolean)\n{\n\tlet ret = jschardet.detect(str) as any as IDetectData;\n\n\tif (plus)\n\t{\n\t\tlet cd = codec_data(ret.encoding);\n\t\tif (cd)\n\t\t{\n\t\t\tif (cd.name)\n\t\t\t{\n\t\t\t\tret.name = cd.name;\n\t\t\t}\n\n\t\t\tret.id = cd.id;\n\t\t}\n\t}\n\n\tif (!ret.name)\n\t{\n\t\tret.name = ret.encoding;\n\t}\n\n\treturn ret;\n}\n\n/**\n * 檢測輸入內容編碼並且轉換為 字串\n */\nexport function decode(str, from: vEncoding = null): string\n{\n\tlet c;\n\n\tif (!str.length)\n\t{\n\t\treturn '';\n\t}\n\n\tif (!from)\n\t{\n\t\tc = detect(str);\n\t\tfrom = c.encoding;\n\t}\n\n\tlet data;\n\n\tlet cd = codec_data(from);\n\n\tlet key: string;\n\n\tif (cd && cd.name && !cd.not)\n\t{\n\t\tkey = cd.name;\n\t}\n\telse\n\t{\n\t\tkey = from;\n\t}\n\n\tswitch (codecDataNameToUpperCase(key))\n\t{\n\t\t//case 'BIG5':\n\t\t//case 'GBK':\n\t\t//case 'GB2312':\n\t\t//case 'UTF-16LE':\n\t\t//case 'UTF-16BE':\n\t\t//case 'EUC-JP':\n\t\t//case 'SHIFT_JIS':\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.BIG5:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.GBK:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.GB2312:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.UTF_16_LE:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.UTF_16_BE:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.EUC_JP:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.SHIFT_JIS:\n\t\t\tdata = iconvLite.decode(str, from);\n\t\t\tbreak;\n\t\t//case 'ASCII':\n\t\t//case 'UTF-8':\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.ASCII:\n\t\tcase CODEC_DATA_NAME_TO_UPPER_CASE.UTF_8:\n\t\t\tdata = str;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tc = c || detect(str);\n\n\t\t\t// @ts-ignore\n\t\t\tif (!iconvLite.skipDecodeWarning)\n\t\t\t{\n\t\t\t\tconsole.warn('decode', from, c);\n\t\t\t}\n\n\t\t\t//data = str;\n\t\t\tdata = iconvLite.decode(str, from);\n\t\t\tbreak;\n\t}\n\n\treturn data;\n}\n\n/**\n * 檢測輸入內容編碼並且轉換為 Buffer\n */\nexport function encode(str, to: vEncoding = ENUM_NODE_ENCODING.UTF8, from: vEncoding = null, options?: IOptionsIconvLite): Buffer\n{\n\tlet buf = BufferFrom(str, ENUM_NODE_ENCODING.UTF8, from);\n\n\t// @ts-ignore\n\treturn iconvLite.encode(buf, to, options);\n}\n\nexport default exports as typeof import('./index');\n"]}